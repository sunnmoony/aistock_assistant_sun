# 数据源配置指南

## 概述

A股智能助手支持多种数据源，可根据需求自由选择配置。

---

## 数据源列表

| 数据源 | 类型 | 特点 | 推荐指数 |
|--------|------|------|----------|
| 通达信(Pytdx) | 免费 | 实时行情、稳定快速 | ⭐⭐⭐⭐⭐ |
| AkShare | 免费 | 功能全面、数据丰富 | ⭐⭐⭐⭐⭐ |
| Tushare | 需注册 | 专业数据、需Token | ⭐⭐⭐ |
| Baostock | 免费 | 复权数据、历史数据 | ⭐⭐⭐ |

---

## 快速配置

### 使用配置向导（推荐新手）

```bash
python data_source_wizard.py
```

按照提示逐步配置即可。

---

## 各数据源详细配置

### 1. 通达信(Pytdx) - 推荐

**特点**：
- 完全免费
- 实时行情数据
- 连接稳定
- 无需注册

**配置方法**：

在 `config.yaml` 中添加：

```yaml
data_sources:
  pytdx:
    enabled: true
    timeout: 10
    max_retries: 3
```

**安装依赖**：
```bash
pip install pytdx
```

---

### 2. AkShare - 推荐

**特点**：
- 完全免费
- 数据种类丰富
- 支持A股、港股、美股
- 支持基金、期货等

**配置方法**：

在 `config.yaml` 中添加：

```yaml
data_sources:
  akshare:
    enabled: true
    timeout: 30
```

**安装依赖**：
```bash
pip install akshare
```

---

### 3. Tushare

**特点**：
- 专业金融数据
- 需要注册获取Token
- 免费版有调用限制
- 数据质量高

**注册步骤**：

1. 访问 https://tushare.pro/register
2. 注册账号
3. 登录后获取Token

**配置方法**：

在 `config.yaml` 中添加：

```yaml
data_sources:
  tushare:
    enabled: true
    token: "你的Token"
    timeout: 30
```

**安装依赖**：
```bash
pip install tushare
```

---

### 4. Baostock

**特点**：
- 完全免费
- 支持历史数据
- 支持复权数据
- 数据较全面

**配置方法**：

在 `config.yaml` 中添加：

```yaml
data_sources:
  baostock:
    enabled: true
    timeout: 30
```

**安装依赖**：
```bash
pip install baostock
```

---

## 数据源优先级

程序会按以下顺序尝试数据源：

1. **Pytdx** (优先级0) - 首选，速度快
2. **AkShare** (优先级1) - 备选，功能全
3. **Tushare** (优先级2) - 可选，需Token
4. **Baostock** (优先级3) - 可选，历史数据

当某个数据源失败时，程序会自动切换到下一个数据源。

---

## 测试数据源

### 方法一：使用配置向导

```bash
python data_source_wizard.py
```

向导会自动测试每个数据源的连接。

### 方法二：手动测试

创建测试脚本 `test_datasource.py`：

```python
# 测试Pytdx
from pytdx.hq import TdxHq_API
api = TdxHq_API()
if api.connect('119.147.212.81', 7709):
    print("Pytdx连接成功")
    api.disconnect()

# 测试AkShare
import akshare as ak
df = ak.stock_zh_a_spot_em()
print(f"AkShare获取到{len(df)}只股票")
```

---

## 常见问题

### Q: Pytdx连接失败？

**可能原因**：
- 网络问题
- 服务器维护

**解决方案**：
- 检查网络连接
- 程序会自动切换到AkShare

### Q: AkShare获取数据慢？

**原因**：AkShare需要从多个网站抓取数据

**解决方案**：
- 增加超时时间
- 使用Pytdx作为主要数据源

### Q: Tushare提示Token无效？

**解决方案**：
- 检查Token是否正确
- 确认账号是否已激活
- 检查是否有足够的积分

---

## 推荐配置

### 新手推荐配置

```yaml
data_sources:
  primary_source: "pytdx"
  pytdx:
    enabled: true
  akshare:
    enabled: true
```

### 完整配置

```yaml
data_sources:
  primary_source: "pytdx"
  pytdx:
    enabled: true
    timeout: 10
  akshare:
    enabled: true
    timeout: 30
  tushare:
    enabled: true
    token: "your_token"
  baostock:
    enabled: true
```

---

**配置完成后，运行程序即可使用！**
